Original code for PeerToPeer from Mihai Corlan ( http://corlan.org/ )